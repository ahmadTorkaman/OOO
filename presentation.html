<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OZONE - The Mutual Language of Design and Production</title>

  <!-- Google Fonts - Montserrat -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">

  <!-- Component CSS -->
  <link rel="stylesheet" href="./Presentation/VariableProximity/VariableProximity.css">
  <link rel="stylesheet" href="./Presentation/MetaBalls/MetaBalls.css">
  <link rel="stylesheet" href="./Presentation/TrueFocus/TrueFocus.css">
  <link rel="stylesheet" href="./Presentation/ValueFlow/ValueFlow.css">

  <!-- IRANYekan Persian Font -->
  <link rel="stylesheet" href="./Presentation/assets/css/fontiran.css">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body, html {
      width: 100%;
      height: 100%;
      overflow: hidden;
      font-family: 'Montserrat', sans-serif;
    }

    #root {
      width: 100%;
      height: 100%;
      position: relative;
    }

    /* Slide 1 - Hero */
    .slide-hero {
      width: 100%;
      height: 100vh;
      position: relative;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.3) 0%, rgba(232, 235, 245, 0.4) 50%, rgba(76, 98, 186, 0.5) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .hero-content {
      position: relative;
      z-index: 10;
      text-align: center;
    }

    .ozone-logo {
      font-family: 'Montserrat', sans-serif;
      font-size: 12rem;
      font-weight: 900;
      color: #000000;
      letter-spacing: 0.1em;
      cursor: default;
      user-select: none;
    }

    .ozone-tagline {
      font-family: 'Montserrat', sans-serif;
      font-size: 1.8rem;
      font-weight: 300;
      color: #333333;
      margin-top: 2rem;
      letter-spacing: 0.05em;
    }

    /* Override for VariableProximity */
    .variable-proximity {
      font-family: 'Montserrat', sans-serif !important;
    }

    /* Make MetaBalls container fill parent */
    .metaballs-container {
      width: 100% !important;
      height: 100% !important;
    }

    .metaballs-container canvas {
      width: 100% !important;
      height: 100% !important;
    }

    /* Slide Navigation System */
    .presentation-container {
      width: 100%;
      height: 100%;
      position: relative;
      overflow: hidden;
    }

    /* Global MetaBalls Background */
    .global-metaballs-background {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      opacity: 0.6;
      pointer-events: none;
    }

    .slide {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1),
                  visibility 0.8s cubic-bezier(0.4, 0, 0.2, 1),
                  background 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .slide.active {
      opacity: 1;
      visibility: visible;
    }

    /* Navigation Indicators */
    .slide-indicators {
      position: fixed;
      right: 2rem;
      top: 50%;
      transform: translateY(-50%);
      z-index: 1000;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .indicator {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: rgba(76, 98, 186, 0.3);
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }

    .indicator.active {
      background: #4c62ba;
      border-color: #4c62ba;
      box-shadow: 0 0 10px rgba(76, 98, 186, 0.5);
    }

    .indicator:hover {
      background: rgba(76, 98, 186, 0.6);
      transform: scale(1.2);
    }

    /* Slide 2 - Philosophy */
    .slide-philosophy {
      width: 100%;
      height: 100vh;
      position: relative;
      background: linear-gradient(135deg, rgba(248, 249, 252, 0.4) 0%, rgba(232, 235, 245, 0.5) 50%, rgba(212, 217, 239, 0.6) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    /* Slide 3 - One System Detail */
    .slide-one-system {
      width: 100%;
      height: 100vh;
      position: relative;
      background: linear-gradient(135deg, rgba(248, 249, 252, 0.4) 0%, rgba(232, 235, 245, 0.5) 50%, rgba(212, 217, 239, 0.6) 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      overflow-y: auto;
      overflow-x: hidden;
      scroll-behavior: smooth;
      padding: 2rem;
      padding-top: 3rem;
      transition: padding 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .slide-one-system.fullscreen {
      padding: 0;
      padding-top: 0;
      background: linear-gradient(135deg, rgba(0, 0, 0, 0.95) 0%, rgba(20, 20, 30, 0.98) 100%);
      overflow: hidden;
    }

    .one-system-header {
      position: relative;
      z-index: 10;
      text-align: center;
      margin-bottom: 2rem;
      opacity: 1;
      transform: translateY(0);
      transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1),
                  transform 0.8s cubic-bezier(0.4, 0, 0.2, 1),
                  margin 0.8s cubic-bezier(0.4, 0, 0.2, 1),
                  height 0.8s cubic-bezier(0.4, 0, 0.2, 1);
      height: auto;
      overflow: hidden;
    }

    .slide-one-system.fullscreen .one-system-header {
      opacity: 0;
      transform: translateY(-100px);
      margin-bottom: 0;
      height: 0;
      pointer-events: none;
    }

    .one-system-scrollable-content {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding-bottom: 2rem;
      z-index: 10;
    }

    .content-section {
      padding: 3rem 2rem;
      margin-bottom: 2rem;
      background: rgba(255, 255, 255, 0.6);
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(76, 98, 186, 0.1);
      backdrop-filter: blur(10px);
    }

    .content-section h2 {
      font-family: 'Montserrat', sans-serif;
      font-size: 2rem;
      font-weight: 700;
      color: #2c3e50;
      margin-bottom: 1.5rem;
    }

    .content-section p {
      font-family: 'Montserrat', sans-serif;
      font-size: 1.1rem;
      line-height: 1.8;
      color: #34495e;
      margin-bottom: 1rem;
    }

    .features-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-top: 2rem;
    }

    .feature-card {
      padding: 1.5rem;
      background: rgba(255, 255, 255, 0.8);
      border-radius: 12px;
      border: 1px solid rgba(76, 98, 186, 0.2);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .feature-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 24px rgba(76, 98, 186, 0.2);
    }

    .feature-card h3 {
      font-family: 'Montserrat', sans-serif;
      font-size: 1.2rem;
      font-weight: 600;
      color: #4c62ba;
      margin-bottom: 0.75rem;
    }

    .feature-card p {
      font-size: 0.95rem;
      line-height: 1.6;
      color: #5a6c7d;
      margin: 0;
    }

    .slide-one-system.fullscreen .one-system-scrollable-content {
      display: none;
    }

    .one-system-content {
      position: relative;
      z-index: 10;
      text-align: center;
      max-width: 95%;
      width: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 3rem 0;
      transition: max-width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .slide-one-system.fullscreen .one-system-content {
      max-width: 100%;
      min-height: 100vh;
      padding: 0;
    }

    .dashboard-intro {
      margin-bottom: 2rem;
      opacity: 1;
      transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .slide-one-system.fullscreen .dashboard-intro {
      opacity: 0;
      height: 0;
      overflow: hidden;
    }

    .dashboard-intro h3 {
      font-family: 'Montserrat', sans-serif;
      font-size: 1.5rem;
      font-weight: 600;
      color: #4c62ba;
      margin-bottom: 0.5rem;
    }

    .dashboard-intro p {
      font-family: 'Montserrat', sans-serif;
      font-size: 1rem;
      color: #5a6c7d;
      margin: 0;
    }

    .scroll-indicator {
      position: relative;
      margin: 3rem auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
      opacity: 1;
      transition: opacity 0.6s cubic-bezier(0.4, 0, 0.2, 1);
      pointer-events: none;
    }

    .scroll-indicator-text {
      font-family: 'Montserrat', sans-serif;
      font-size: 0.9rem;
      font-weight: 400;
      color: #4c62ba;
      opacity: 0.8;
    }

    .scroll-indicator-icon {
      width: 24px;
      height: 36px;
      border: 2px solid #4c62ba;
      border-radius: 12px;
      position: relative;
      opacity: 0.6;
    }

    .scroll-indicator-icon::before {
      content: '';
      position: absolute;
      top: 6px;
      left: 50%;
      transform: translateX(-50%);
      width: 4px;
      height: 8px;
      background: #4c62ba;
      border-radius: 2px;
      animation: scrollAnimation 2s ease-in-out infinite;
    }

    @keyframes scrollAnimation {
      0%, 100% {
        opacity: 0;
        transform: translateX(-50%) translateY(0);
      }
      50% {
        opacity: 1;
        transform: translateX(-50%) translateY(12px);
      }
    }

    .one-system-title {
      font-family: 'Montserrat', sans-serif;
      font-size: 3rem;
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 0.5rem;
      letter-spacing: 0.05em;
    }

    .one-system-subtitle {
      font-family: iranyekan, sans-serif;
      font-size: 1.5rem;
      font-weight: 400;
      color: #555;
      direction: rtl;
      margin-bottom: 0;
    }

    .system-features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 2rem;
      margin-top: 3rem;
    }

    .feature-card {
      background: rgba(255, 255, 255, 0.8);
      padding: 2rem;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      cursor: pointer;
    }

    .feature-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 8px 30px rgba(76, 98, 186, 0.3);
    }

    .feature-card h3 {
      font-family: 'Montserrat', sans-serif;
      font-size: 1.5rem;
      font-weight: 600;
      color: #4c62ba;
      margin-bottom: 1rem;
    }

    .feature-card p {
      font-family: 'Montserrat', sans-serif;
      font-size: 1rem;
      font-weight: 400;
      color: #666;
      line-height: 1.6;
    }

    .back-hint {
      position: absolute;
      bottom: 2rem;
      left: 50%;
      transform: translateX(-50%);
      font-family: 'Montserrat', sans-serif;
      font-size: 1rem;
      font-weight: 300;
      color: #4c62ba;
      opacity: 0.6;
      pointer-events: none;
    }

    /* macOS Window Styles */
    .macos-window {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 12px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3),
                  0 0 1px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      position: relative;
      width: 90vw;
      max-width: 1400px;
      height: 75vh;
      max-height: 800px;
      transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1),
                  box-shadow 0.8s cubic-bezier(0.4, 0, 0.2, 1),
                  border-radius 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .macos-window.fullscreen {
      width: 100vw;
      height: 100vh;
      max-width: 100vw;
      max-height: 100vh;
      border-radius: 0;
      box-shadow: none;
      background: rgba(255, 255, 255, 1);
    }

    .macos-window.fullscreen .macos-titlebar {
      opacity: 0;
      height: 0;
      overflow: hidden;
      border-bottom: none;
      transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1),
                  height 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .macos-window.fullscreen .macos-window-content {
      height: 100%;
    }

    .macos-titlebar {
      background: linear-gradient(to bottom,
                  rgba(232, 232, 232, 0.98) 0%,
                  rgba(220, 220, 220, 0.98) 100%);
      height: 40px;
      display: flex;
      align-items: center;
      padding: 0 1rem;
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      position: relative;
      transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1),
                  height 0.8s cubic-bezier(0.4, 0, 0.2, 1),
                  border-bottom 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .macos-traffic-lights {
      display: flex;
      gap: 8px;
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
    }

    .macos-traffic-light {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      border: 0.5px solid rgba(0, 0, 0, 0.15);
      cursor: pointer;
      transition: all 0.2s ease;
      position: relative;
    }

    .macos-traffic-light::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    .macos-traffic-light:hover::before {
      opacity: 1;
    }

    .macos-traffic-light.close {
      background: linear-gradient(135deg, #FF5F57 0%, #FF5A52 100%);
    }

    .macos-traffic-light.close:hover::before {
      content: '×';
      font-size: 10px;
      font-weight: bold;
      color: rgba(0, 0, 0, 0.6);
    }

    .macos-traffic-light.minimize {
      background: linear-gradient(135deg, #FFBD2E 0%, #FFB923 100%);
    }

    .macos-traffic-light.minimize:hover::before {
      content: '−';
      font-size: 10px;
      font-weight: bold;
      color: rgba(0, 0, 0, 0.6);
    }

    .macos-traffic-light.maximize {
      background: linear-gradient(135deg, #28CA42 0%, #27C93F 100%);
    }

    .macos-traffic-light.maximize:hover::before {
      content: '+';
      font-size: 10px;
      font-weight: bold;
      color: rgba(0, 0, 0, 0.6);
    }

    .macos-window-title {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      font-family: 'Montserrat', sans-serif;
      font-size: 13px;
      font-weight: 500;
      color: rgba(0, 0, 0, 0.85);
      letter-spacing: 0.01em;
    }

    .macos-window-content {
      padding: 0;
      height: calc(100% - 40px);
      background: rgba(255, 255, 255, 0.98);
      overflow: hidden;
      position: relative;
    }

    .macos-window-content iframe {
      width: 100%;
      height: 100%;
      border: none;
      display: block;
    }

    /* Scroll capture overlay for fullscreen */
    .scroll-capture-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 9999;
      pointer-events: none;
      background: transparent;
    }

    .scroll-capture-overlay.hidden {
      display: none;
    }

    /* Custom scrollbar for macOS window */
    .macos-window-content::-webkit-scrollbar {
      width: 8px;
    }

    .macos-window-content::-webkit-scrollbar-track {
      background: transparent;
    }

    .macos-window-content::-webkit-scrollbar-thumb {
      background: rgba(0, 0, 0, 0.2);
      border-radius: 4px;
    }

    .macos-window-content::-webkit-scrollbar-thumb:hover {
      background: rgba(0, 0, 0, 0.3);
    }

    .philosophy-content {
      position: relative;
      z-index: 10;
      text-align: center;
      max-width: 90%;
    }

    .philosophy-title {
      font-family: 'Montserrat', sans-serif;
      font-size: 1.2rem;
      font-weight: 300;
      color: #666;
      letter-spacing: 0.3em;
      text-transform: uppercase;
      margin-bottom: 4rem;
      opacity: 0.7;
    }

    .philosophy-focus {
      font-size: 5rem;
      color: #2c3e50;
    }

    /* Override TrueFocus styles for this slide */
    .slide-philosophy .focus-container {
      flex-direction: column;
      gap: 3rem;
    }

    .slide-philosophy .focus-word {
      font-family: 'Montserrat', sans-serif;
      font-size: 4.5rem;
      font-weight: 400;
      color: #2c3e50;
      transition: filter 0.6s ease, color 0.6s ease;
      display: flex;
      align-items: center;
      gap: 2rem;
      justify-content: center;
      position: relative;
    }

    .slide-philosophy .focus-word::before {
      content: '';
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      width: 2px;
      height: 80%;
      background: linear-gradient(to bottom, transparent, rgba(76, 98, 186, 0.3), transparent);
    }

    .slide-philosophy .focus-word .english {
      font-family: 'Montserrat', sans-serif;
      font-weight: 400;
      order: 2;
      text-align: left;
      flex: 1;
    }

    .slide-philosophy .focus-word .persian {
      font-family: iranyekan, sans-serif;
      font-weight: 400;
      direction: rtl;
      order: 1;
      text-align: right;
      flex: 1;
    }

    .slide-philosophy .focus-word em {
      font-style: italic;
      font-weight: 400;
    }

    .slide-philosophy .corner {
      border-color: #4c62ba;
      filter: drop-shadow(0px 0px 8px rgba(76, 98, 186, 0.6));
    }

    .slide-philosophy .focus-word {
      cursor: pointer;
      user-select: none;
    }

    .slide-philosophy .focus-word:first-child:hover {
      transform: scale(1.05);
      transition: transform 0.3s ease;
    }

    /* Responsive text */
    @media (max-width: 1200px) {
      .ozone-logo {
        font-size: 8rem;
      }
      .philosophy-focus {
        font-size: 3rem;
      }
      .slide-philosophy .focus-word {
        font-size: 3rem;
        gap: 1.5rem;
      }
    }

    @media (max-width: 768px) {
      .ozone-logo {
        font-size: 5rem;
      }
      .ozone-tagline {
        font-size: 1.2rem;
      }
      .philosophy-focus {
        font-size: 2rem;
      }
      .slide-philosophy .focus-word {
        font-size: 2rem;
        gap: 1rem;
        flex-direction: column;
      }
      .slide-philosophy .focus-container {
        gap: 2rem;
      }
    }

    /* ============================================ */
    /* Persian Text Styling with IRANYekan Font    */
    /* ============================================ */

    .persian-text,
    .persian-subtitle {
      font-family: iranyekan, 'Segoe UI', Tahoma, sans-serif;
      direction: rtl;
      text-align: right;
      line-height: 1.9;
      letter-spacing: -0.01em;
    }

    .persian-text {
      color: #5a6c7d;
      font-weight: 500;
    }

    .persian-subtitle {
      color: #6b7c8e;
      font-weight: 400;
      line-height: 2;
    }

    /* Ensure Persian text always uses IRANYekan in content-section */
    .content-section .persian-text,
    .content-section .persian-subtitle,
    .content-section h2 .persian-text,
    .content-section h3 .persian-text {
      font-family: iranyekan, 'Segoe UI', Tahoma, sans-serif !important;
    }

    /* Headers with Persian */
    h1 .persian-text,
    h2 .persian-text,
    h3 .persian-text {
      font-weight: 700;
      display: inline-block;
      margin-right: 0.5rem;
    }

    /* Inline Persian in headers - better spacing */
    h2 .persian-text {
      font-size: 0.85em;
      vertical-align: middle;
      opacity: 0.9;
    }

    h3 .persian-text {
      font-size: 0.8em;
      vertical-align: middle;
      opacity: 0.88;
    }

    h4 .persian-text {
      font-size: 0.82em;
      font-weight: 600;
      vertical-align: middle;
      opacity: 0.85;
    }

    h5 .persian-text,
    h6 .persian-text {
      font-size: 0.85em;
      font-weight: 600;
    }

    /* Paragraph subtitles */
    p.persian-subtitle,
    .content-section p.persian-subtitle {
      font-family: iranyekan, 'Segoe UI', Tahoma, sans-serif !important;
      margin-top: 0.6rem !important;
      padding: 0.5rem 0;
      background: linear-gradient(90deg, rgba(76, 98, 186, 0.03) 0%, transparent 100%);
      border-right: 3px solid rgba(76, 98, 186, 0.3);
      padding-right: 1rem;
      border-radius: 0 4px 4px 0;
    }

    /* Inline Persian text in lists */
    li .persian-text {
      font-family: iranyekan, 'Segoe UI', Tahoma, sans-serif !important;
      display: block;
      margin-top: 0.3rem;
      font-size: 0.9em;
      padding-right: 0.5rem;
    }

    /* Button Persian text */
    button .persian-text {
      font-family: iranyekan, 'Segoe UI', Tahoma, sans-serif !important;
      font-weight: 500;
      margin-right: 0.3rem;
    }

    /* Modal Persian content */
    .metric-modal-content .persian-subtitle,
    .metric-modal-content .persian-text {
      font-family: iranyekan, 'Segoe UI', Tahoma, sans-serif !important;
      text-align: right;
      padding-right: 0.5rem;
    }

    /* Benefits section Persian */
    .benefit-text .persian-text {
      font-family: iranyekan, 'Segoe UI', Tahoma, sans-serif !important;
      font-size: 0.88em;
      color: #5a6c7d;
      font-weight: 400;
      line-height: 1.7;
      text-align: right;
      direction: rtl;
      white-space: nowrap;
    }

    /* Employee info Persian */
    .employee-info .persian-subtitle,
    .employee-info .persian-text {
      font-family: iranyekan, 'Segoe UI', Tahoma, sans-serif !important;
      font-size: 0.78em;
      margin-top: 0.25rem;
      opacity: 0.8;
    }

    /* Scroll indicator Persian */
    .scroll-indicator-text .persian-text {
      font-family: iranyekan, 'Segoe UI', Tahoma, sans-serif !important;
      font-size: 0.92em;
      margin-top: 0.4rem;
      opacity: 0.85;
    }

    /* Dashboard intro Persian */
    .dashboard-intro .persian-subtitle,
    .dashboard-intro .persian-text {
      font-family: iranyekan, 'Segoe UI', Tahoma, sans-serif !important;
      font-size: 0.87em;
      padding-right: 0;
      border-right: none;
      background: none;
    }

    /* Feature cards Persian */
    .feature-card .persian-subtitle,
    .feature-card .persian-text {
      font-family: iranyekan, 'Segoe UI', Tahoma, sans-serif !important;
      font-size: 0.88em;
      margin-top: 0.7rem;
      padding: 0.6rem 1rem;
      background: linear-gradient(270deg, rgba(76, 98, 186, 0.04) 0%, transparent 100%);
      border-right: 2px solid rgba(76, 98, 186, 0.25);
      border-radius: 0 6px 6px 0;
    }

    /* Metric cards Persian */
    .metric-card .persian-subtitle,
    .metric-card .persian-text {
      font-family: iranyekan, 'Segoe UI', Tahoma, sans-serif !important;
      font-size: 0.82em;
      margin-top: 0.4rem;
      opacity: 0.8;
    }

    /* Back hint Persian */
    .back-hint .persian-text {
      font-family: iranyekan, 'Segoe UI', Tahoma, sans-serif !important;
      font-weight: 400;
      opacity: 0.9;
    }

    /* Value flow section Persian */
    .value-flow-header .subtitle-persian {
      font-family: iranyekan, 'Segoe UI', Tahoma, sans-serif !important;
      direction: rtl;
      text-align: center;
      font-weight: 400;
      color: #666;
      font-size: 1.1rem;
      line-height: 1.7;
      max-width: 700px;
      margin: 0.5rem auto;
    }

    /* Output node Persian */
    .output-node .persian-text {
      font-family: iranyekan, 'Segoe UI', Tahoma, sans-serif !important;
      font-size: 0.85em;
      font-weight: 600;
    }

    /* Improve spacing for Persian in mixed content */
    span.persian-text:not(:first-child) {
      margin-right: 0.4rem;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      .persian-text,
      .persian-subtitle {
        font-size: 0.95em;
        line-height: 2.1;
      }

      p.persian-subtitle {
        padding: 0.4rem 0.8rem;
        border-right-width: 2px;
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>

  <!-- Import map for ES modules -->
  <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react/": "https://esm.sh/react@18.2.0/",
        "react-dom": "https://esm.sh/react-dom@18.2.0",
        "react-dom/": "https://esm.sh/react-dom@18.2.0/",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "motion/react": "https://esm.sh/motion@11/react?deps=react@18.2.0,react-dom@18.2.0",
        "matter-js": "https://esm.sh/matter-js@0.19.0"
      }
    }
  </script>

  <!-- OGL Inline minimal implementation to avoid CORS issues -->
  <script>
    // Minimal OGL implementation inline to avoid all CDN CORS issues
    window.OGLModule = (function() {
      class Renderer {
        constructor(config = {}) {
          const canvas = document.createElement('canvas');
          const gl = canvas.getContext('webgl', {
            alpha: config.alpha !== undefined ? config.alpha : true,
            premultipliedAlpha: config.premultipliedAlpha !== undefined ? config.premultipliedAlpha : true
          });
          this.gl = gl;
          this.canvas = canvas;
          this.dpr = config.dpr || 1;
        }
        setSize(width, height) {
          this.canvas.width = width;
          this.canvas.height = height;
        }
        render(scene) {
          const gl = this.gl;
          if (scene && scene.program) {
            gl.useProgram(scene.program.program);
            gl.drawArrays(gl.TRIANGLES, 0, 3);
          }
        }
      }

      class Program {
        constructor(gl, config) {
          this.gl = gl;
          this.uniforms = config.uniforms || {};

          // Create minimal WebGL program
          const vertexShader = gl.createShader(gl.VERTEX_SHADER);
          gl.shaderSource(vertexShader, config.vertex);
          gl.compileShader(vertexShader);

          const fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);
          gl.shaderSource(fragmentShader, config.fragment);
          gl.compileShader(fragmentShader);

          this.program = gl.createProgram();
          gl.attachShader(this.program, vertexShader);
          gl.attachShader(this.program, fragmentShader);
          gl.linkProgram(this.program);
        }
      }

      class Mesh {
        constructor(gl, config) {
          this.gl = gl;
          this.geometry = config.geometry;
          this.program = config.program;
        }
      }

      class Triangle {
        constructor(gl) {
          this.gl = gl;
        }
      }

      class Vec3 {
        constructor(x = 0, y = 0, z = 0) {
          this.x = x;
          this.y = y;
          this.z = z;
        }
        set(x, y, z) {
          this.x = x;
          this.y = y;
          this.z = z;
        }
      }

      return { Renderer, Program, Mesh, Triangle, Vec3 };
    })();
  </script>

  <!-- Main App - Using type=module for ES imports -->
  <script type="module">
    import React, { useState, useRef, useEffect, useMemo, forwardRef, createElement as h } from 'react';
    import { createRoot } from 'react-dom/client';
    import { motion } from 'motion/react';
    import Matter from 'matter-js';

    // OGL loaded from inline implementation above
    const { Renderer, Program, Mesh, Triangle, Vec3 } = window.OGLModule;

    // ============================================
    // MetaBalls Component
    // ============================================

    function parseHexColor(hex) {
      const c = hex.replace('#', '');
      const r = parseInt(c.substring(0, 2), 16) / 255;
      const g = parseInt(c.substring(2, 4), 16) / 255;
      const b = parseInt(c.substring(4, 6), 16) / 255;
      return [r, g, b];
    }

    function fract(x) {
      return x - Math.floor(x);
    }

    function hash31(p) {
      let r = [p * 0.1031, p * 0.103, p * 0.0973].map(fract);
      const r_yzx = [r[1], r[2], r[0]];
      const dotVal = r[0] * (r_yzx[0] + 33.33) + r[1] * (r_yzx[1] + 33.33) + r[2] * (r_yzx[2] + 33.33);
      for (let i = 0; i < 3; i++) {
        r[i] = fract(r[i] + dotVal);
      }
      return r;
    }

    function hash33(v) {
      let p = [v[0] * 0.1031, v[1] * 0.103, v[2] * 0.0973].map(fract);
      const p_yxz = [p[1], p[0], p[2]];
      const dotVal = p[0] * (p_yxz[0] + 33.33) + p[1] * (p_yxz[1] + 33.33) + p[2] * (p_yxz[2] + 33.33);
      for (let i = 0; i < 3; i++) {
        p[i] = fract(p[i] + dotVal);
      }
      const p_xxy = [p[0], p[0], p[1]];
      const p_yxx = [p[1], p[0], p[0]];
      const p_zyx = [p[2], p[1], p[0]];
      const result = [];
      for (let i = 0; i < 3; i++) {
        result[i] = fract((p_xxy[i] + p_yxx[i]) * p_zyx[i]);
      }
      return result;
    }

    const vertex = `#version 300 es
    precision highp float;
    layout(location = 0) in vec2 position;
    void main() {
      gl_Position = vec4(position, 0.0, 1.0);
    }
    `;

    const fragment = `#version 300 es
    precision highp float;
    uniform vec3 iResolution;
    uniform float iTime;
    uniform vec3 iMouse;
    uniform vec3 iColor;
    uniform vec3 iCursorColor;
    uniform float iAnimationSize;
    uniform int iBallCount;
    uniform float iCursorBallSize;
    uniform vec3 iMetaBalls[50];
    uniform float iClumpFactor;
    uniform bool enableTransparency;
    out vec4 outColor;

    float getMetaBallValue(vec2 c, float r, vec2 p) {
      vec2 d = p - c;
      float dist2 = dot(d, d);
      return (r * r) / dist2;
    }

    void main() {
      vec2 fc = gl_FragCoord.xy;
      float scale = iAnimationSize / iResolution.y;
      vec2 coord = (fc - iResolution.xy * 0.5) * scale;
      vec2 mouseW = (iMouse.xy - iResolution.xy * 0.5) * scale;
      float m1 = 0.0;
      for (int i = 0; i < 50; i++) {
        if (i >= iBallCount) break;
        m1 += getMetaBallValue(iMetaBalls[i].xy, iMetaBalls[i].z, coord);
      }
      float m2 = getMetaBallValue(mouseW, iCursorBallSize, coord);
      float total = m1 + m2;
      float f = smoothstep(-1.0, 1.0, (total - 1.3) / min(1.0, fwidth(total)));
      vec3 cFinal = vec3(0.0);
      if (total > 0.0) {
        float alpha1 = m1 / total;
        float alpha2 = m2 / total;
        cFinal = iColor * alpha1 + iCursorColor * alpha2;
      }
      outColor = vec4(cFinal * f, enableTransparency ? f : 1.0);
    }
    `;

    function MetaBalls({
      className = '',
      color = '#4c62ba',
      speed = 0.2,
      enableMouseInteraction = true,
      hoverSmoothness = 0.05,
      animationSize = 40,
      ballCount = 12,
      clumpFactor = 1.2,
      cursorBallSize = 2,
      cursorBallColor = '#6a7fc1',
      enableTransparency = true
    }) {
      const containerRef = useRef(null);

      useEffect(() => {
        const container = containerRef.current;
        if (!container) return;

        const dpr = 1;
        const renderer = new Renderer({ dpr, alpha: true, premultipliedAlpha: false });
        const gl = renderer.gl;
        gl.clearColor(0, 0, 0, 0);
        container.appendChild(gl.canvas);

        const geometry = new Triangle(gl);
        const [r1, g1, b1] = parseHexColor(color);
        const [r2, g2, b2] = parseHexColor(cursorBallColor);

        const metaBallsUniform = [];
        for (let i = 0; i < 50; i++) {
          metaBallsUniform.push(new Vec3(0, 0, 0));
        }

        const program = new Program(gl, {
          vertex,
          fragment,
          uniforms: {
            iTime: { value: 0 },
            iResolution: { value: new Vec3(0, 0, 0) },
            iMouse: { value: new Vec3(0, 0, 0) },
            iColor: { value: new Vec3(r1, g1, b1) },
            iCursorColor: { value: new Vec3(r2, g2, b2) },
            iAnimationSize: { value: animationSize },
            iBallCount: { value: ballCount },
            iCursorBallSize: { value: cursorBallSize },
            iMetaBalls: { value: metaBallsUniform },
            iClumpFactor: { value: clumpFactor },
            enableTransparency: { value: enableTransparency }
          }
        });

        const mesh = new Mesh(gl, { geometry, program });

        const effectiveBallCount = Math.min(ballCount, 50);
        const ballParams = [];
        for (let i = 0; i < effectiveBallCount; i++) {
          const idx = i + 1;
          const h1 = hash31(idx);
          const st = h1[0] * (2 * Math.PI);
          const dtFactor = 0.1 * Math.PI + h1[1] * (0.4 * Math.PI - 0.1 * Math.PI);
          const baseScale = 5.0 + h1[1] * (10.0 - 5.0);
          const h2 = hash33(h1);
          const toggle = Math.floor(h2[0] * 2.0);
          const radiusVal = 0.3 + h2[2] * (1.5 - 0.3); // Variable sizes: small minimum, less thick maximum
          ballParams.push({ st, dtFactor, baseScale, toggle, radius: radiusVal });
        }

        const mouseBallPos = { x: 0, y: 0 };
        let pointerInside = false;
        let pointerX = 0;
        let pointerY = 0;

        function resize() {
          if (!container) return;
          const width = container.clientWidth;
          const height = container.clientHeight;
          renderer.setSize(width * dpr, height * dpr);
          gl.canvas.style.width = width + 'px';
          gl.canvas.style.height = height + 'px';
          program.uniforms.iResolution.value.set(gl.canvas.width, gl.canvas.height, 0);
        }
        window.addEventListener('resize', resize);
        resize();

        function onPointerMove(e) {
          if (!enableMouseInteraction) return;
          const rect = container.getBoundingClientRect();
          const px = e.clientX - rect.left;
          const py = e.clientY - rect.top;
          pointerX = (px / rect.width) * gl.canvas.width;
          pointerY = (1 - py / rect.height) * gl.canvas.height;
        }
        function onPointerEnter() {
          if (!enableMouseInteraction) return;
          pointerInside = true;
        }
        function onPointerLeave() {
          if (!enableMouseInteraction) return;
          pointerInside = false;
        }
        container.addEventListener('pointermove', onPointerMove);
        container.addEventListener('pointerenter', onPointerEnter);
        container.addEventListener('pointerleave', onPointerLeave);

        const startTime = performance.now();
        let animationFrameId;
        function update(t) {
          animationFrameId = requestAnimationFrame(update);
          const elapsed = (t - startTime) * 0.001;
          program.uniforms.iTime.value = elapsed;

          // Flowing animation for all balls
          for (let i = 0; i < effectiveBallCount; i++) {
            const p = ballParams[i];
            const dt = elapsed * speed * p.dtFactor;
            const th = p.st + dt;
            const x = Math.cos(th);
            const y = Math.sin(th + dt * p.toggle);
            const posX = x * p.baseScale * clumpFactor;
            const posY = y * p.baseScale * clumpFactor;
            metaBallsUniform[i].set(posX, posY, p.radius);
          }

          let targetX, targetY;
          if (pointerInside) {
            targetX = pointerX;
            targetY = pointerY;
          } else {
            const cx = gl.canvas.width * 0.5;
            const cy = gl.canvas.height * 0.5;
            const rx = gl.canvas.width * 0.15;
            const ry = gl.canvas.height * 0.15;
            targetX = cx + Math.cos(elapsed * speed) * rx;
            targetY = cy + Math.sin(elapsed * speed) * ry;
          }
          mouseBallPos.x += (targetX - mouseBallPos.x) * hoverSmoothness;
          mouseBallPos.y += (targetY - mouseBallPos.y) * hoverSmoothness;
          program.uniforms.iMouse.value.set(mouseBallPos.x, mouseBallPos.y, 0);

          renderer.render(mesh);
        }
        animationFrameId = requestAnimationFrame(update);

        return () => {
          cancelAnimationFrame(animationFrameId);
          window.removeEventListener('resize', resize);
          container.removeEventListener('pointermove', onPointerMove);
          container.removeEventListener('pointerenter', onPointerEnter);
          container.removeEventListener('pointerleave', onPointerLeave);
          if (gl.canvas && container.contains(gl.canvas)) {
            container.removeChild(gl.canvas);
          }
          gl.getExtension('WEBGL_lose_context')?.loseContext();
        };
      }, [color, cursorBallColor, speed, enableMouseInteraction, hoverSmoothness, animationSize, ballCount, clumpFactor, cursorBallSize, enableTransparency]);

      return h('div', { ref: containerRef, className: `metaballs-container ${className}` });
    }

    // ============================================
    // VariableProximity Component
    // ============================================

    function useAnimationFrame(callback) {
      useEffect(() => {
        let frameId;
        const loop = () => {
          callback();
          frameId = requestAnimationFrame(loop);
        };
        frameId = requestAnimationFrame(loop);
        return () => cancelAnimationFrame(frameId);
      }, [callback]);
    }

    function useMousePositionRef(containerRef) {
      const positionRef = useRef({ x: 0, y: 0 });

      useEffect(() => {
        const updatePosition = (x, y) => {
          if (containerRef?.current) {
            const rect = containerRef.current.getBoundingClientRect();
            positionRef.current = { x: x - rect.left, y: y - rect.top };
          } else {
            positionRef.current = { x, y };
          }
        };

        const handleMouseMove = ev => updatePosition(ev.clientX, ev.clientY);
        const handleTouchMove = ev => {
          const touch = ev.touches[0];
          updatePosition(touch.clientX, touch.clientY);
        };

        window.addEventListener('mousemove', handleMouseMove);
        window.addEventListener('touchmove', handleTouchMove);
        return () => {
          window.removeEventListener('mousemove', handleMouseMove);
          window.removeEventListener('touchmove', handleTouchMove);
        };
      }, [containerRef]);

      return positionRef;
    }

    const VariableProximity = forwardRef((props, ref) => {
      const {
        label,
        fromFontVariationSettings = "'wght' 400",
        toFontVariationSettings = "'wght' 900",
        containerRef,
        radius = 150,
        falloff = 'linear',
        className = '',
        onClick,
        style,
        ...restProps
      } = props;

      const letterRefs = useRef([]);
      const interpolatedSettingsRef = useRef([]);
      const mousePositionRef = useMousePositionRef(containerRef);
      const lastPositionRef = useRef({ x: null, y: null });

      const parsedSettings = useMemo(() => {
        const parseSettings = settingsStr =>
          new Map(
            settingsStr
              .split(',')
              .map(s => s.trim())
              .map(s => {
                const [name, value] = s.split(' ');
                return [name.replace(/['"]/g, ''), parseFloat(value)];
              })
          );

        const fromSettings = parseSettings(fromFontVariationSettings);
        const toSettings = parseSettings(toFontVariationSettings);

        return Array.from(fromSettings.entries()).map(([axis, fromValue]) => ({
          axis,
          fromValue,
          toValue: toSettings.get(axis) ?? fromValue
        }));
      }, [fromFontVariationSettings, toFontVariationSettings]);

      const calculateDistance = (x1, y1, x2, y2) => Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);

      const calculateFalloff = distance => {
        const norm = Math.min(Math.max(1 - distance / radius, 0), 1);
        switch (falloff) {
          case 'exponential':
            return norm ** 2;
          case 'gaussian':
            return Math.exp(-((distance / (radius / 2)) ** 2) / 2);
          case 'linear':
          default:
            return norm;
        }
      };

      useAnimationFrame(() => {
        if (!containerRef?.current) return;
        const containerRect = containerRef.current.getBoundingClientRect();
        const { x, y } = mousePositionRef.current;
        if (lastPositionRef.current.x === x && lastPositionRef.current.y === y) {
          return;
        }
        lastPositionRef.current = { x, y };

        letterRefs.current.forEach((letterRef, index) => {
          if (!letterRef) return;

          const rect = letterRef.getBoundingClientRect();
          const letterCenterX = rect.left + rect.width / 2 - containerRect.left;
          const letterCenterY = rect.top + rect.height / 2 - containerRect.top;

          const distance = calculateDistance(
            mousePositionRef.current.x,
            mousePositionRef.current.y,
            letterCenterX,
            letterCenterY
          );

          if (distance >= radius) {
            letterRef.style.fontVariationSettings = fromFontVariationSettings;
            return;
          }

          const falloffValue = calculateFalloff(distance);
          const newSettings = parsedSettings
            .map(({ axis, fromValue, toValue }) => {
              const interpolatedValue = fromValue + (toValue - fromValue) * falloffValue;
              return `'${axis}' ${interpolatedValue}`;
            })
            .join(', ');

          interpolatedSettingsRef.current[index] = newSettings;
          letterRef.style.fontVariationSettings = newSettings;
        });
      });

      const words = label.split(' ');
      let letterIndex = 0;

      return h(
        'span',
        {
          ref,
          className: `${className} variable-proximity`,
          onClick,
          style: { display: 'inline', ...style },
          ...restProps
        },
        words.map((word, wordIndex) =>
          h(
            'span',
            { key: wordIndex, style: { display: 'inline-block', whiteSpace: 'nowrap' } },
            word.split('').map(letter => {
              const currentLetterIndex = letterIndex++;
              return h(
                motion.span,
                {
                  key: currentLetterIndex,
                  ref: el => {
                    letterRefs.current[currentLetterIndex] = el;
                  },
                  style: {
                    display: 'inline-block',
                    fontVariationSettings: interpolatedSettingsRef.current[currentLetterIndex]
                  },
                  'aria-hidden': true
                },
                letter
              );
            }),
            wordIndex < words.length - 1 && h('span', { style: { display: 'inline-block' } }, '\u00A0')
          )
        ),
        h('span', { className: 'sr-only' }, label)
      );
    });

    // ============================================
    // TrueFocus Component
    // ============================================

    function TrueFocus({
      sentence = 'True Focus',
      separator = ' ',
      manualMode = false,
      blurAmount = 5,
      borderColor = '#4c62ba',
      glowColor = 'rgba(76, 98, 186, 0.6)',
      animationDuration = 0.5,
      pauseBetweenAnimations = 1
    }) {
      const words = sentence.split(separator);
      const [currentIndex, setCurrentIndex] = useState(0);
      const [lastActiveIndex, setLastActiveIndex] = useState(null);
      const containerRef = useRef(null);
      const wordRefs = useRef([]);
      const [focusRect, setFocusRect] = useState({ x: 0, y: 0, width: 0, height: 0 });

      useEffect(() => {
        if (!manualMode) {
          const interval = setInterval(
            () => {
              setCurrentIndex(prev => (prev + 1) % words.length);
            },
            (animationDuration + pauseBetweenAnimations) * 1000
          );

          return () => clearInterval(interval);
        }
      }, [manualMode, animationDuration, pauseBetweenAnimations, words.length]);

      useEffect(() => {
        if (currentIndex === null || currentIndex === -1) return;

        if (!wordRefs.current[currentIndex] || !containerRef.current) return;

        const parentRect = containerRef.current.getBoundingClientRect();
        const activeRect = wordRefs.current[currentIndex].getBoundingClientRect();

        setFocusRect({
          x: activeRect.left - parentRect.left,
          y: activeRect.top - parentRect.top,
          width: activeRect.width,
          height: activeRect.height
        });
      }, [currentIndex, words.length]);

      const handleMouseEnter = index => {
        if (manualMode) {
          setLastActiveIndex(index);
          setCurrentIndex(index);
        }
      };

      const handleMouseLeave = () => {
        if (manualMode) {
          setCurrentIndex(lastActiveIndex);
        }
      };

      return h(
        'div',
        { className: 'focus-container', ref: containerRef },
        words.map((word, index) => {
          const isActive = index === currentIndex;
          return h(
            'span',
            {
              key: index,
              ref: el => (wordRefs.current[index] = el),
              className: `focus-word ${manualMode ? 'manual' : ''} ${isActive && !manualMode ? 'active' : ''}`,
              style: {
                filter: manualMode
                  ? isActive
                    ? 'blur(0px)'
                    : `blur(${blurAmount}px)`
                  : isActive
                    ? 'blur(0px)'
                    : `blur(${blurAmount}px)`,
                '--border-color': borderColor,
                '--glow-color': glowColor,
                transition: `filter ${animationDuration}s ease`
              },
              onMouseEnter: () => handleMouseEnter(index),
              onMouseLeave: handleMouseLeave
            },
            word
          );
        }),
        h(
          motion.div,
          {
            className: 'focus-frame',
            animate: {
              x: focusRect.x,
              y: focusRect.y,
              width: focusRect.width,
              height: focusRect.height,
              opacity: currentIndex >= 0 ? 1 : 0
            },
            transition: {
              duration: animationDuration
            },
            style: {
              '--border-color': borderColor,
              '--glow-color': glowColor
            }
          },
          h('span', { className: 'corner top-left' }),
          h('span', { className: 'corner top-right' }),
          h('span', { className: 'corner bottom-left' }),
          h('span', { className: 'corner bottom-right' })
        )
      );
    }

    // ============================================
    // BilingualTrueFocus Component
    // ============================================

    function BilingualTrueFocus({
      items = [],
      manualMode = true,
      blurAmount = 8,
      borderColor = '#4c62ba',
      glowColor = 'rgba(76, 98, 186, 0.6)',
      animationDuration = 0.6
    }) {
      const [currentIndex, setCurrentIndex] = useState(0);
      const [lastActiveIndex, setLastActiveIndex] = useState(null);
      const containerRef = useRef(null);
      const wordRefs = useRef([]);
      const [focusRect, setFocusRect] = useState({ x: 0, y: 0, width: 0, height: 0 });

      useEffect(() => {
        if (currentIndex === null || currentIndex === -1) return;

        if (!wordRefs.current[currentIndex] || !containerRef.current) return;

        const parentRect = containerRef.current.getBoundingClientRect();
        const activeRect = wordRefs.current[currentIndex].getBoundingClientRect();

        setFocusRect({
          x: activeRect.left - parentRect.left,
          y: activeRect.top - parentRect.top,
          width: activeRect.width,
          height: activeRect.height
        });
      }, [currentIndex]);

      const handleMouseEnter = index => {
        if (manualMode) {
          setLastActiveIndex(index);
          setCurrentIndex(index);
        }
      };

      const handleMouseLeave = () => {
        if (manualMode) {
          setCurrentIndex(lastActiveIndex);
        }
      };

      return h(
        'div',
        { className: 'focus-container', ref: containerRef },
        items.map((item, index) => {
          const isActive = index === currentIndex;
          return h(
            'span',
            {
              key: index,
              ref: el => (wordRefs.current[index] = el),
              className: `focus-word ${manualMode ? 'manual' : ''} ${isActive && !manualMode ? 'active' : ''}`,
              style: {
                filter: isActive ? 'blur(0px)' : `blur(${blurAmount}px)`,
                transition: `filter ${animationDuration}s ease`
              },
              onMouseEnter: () => handleMouseEnter(index),
              onMouseLeave: handleMouseLeave
            },
            h('span', { className: 'english' }, item.english),
            h('span', { className: 'persian' }, item.persian)
          );
        }),
        h(
          motion.div,
          {
            className: 'focus-frame',
            animate: {
              x: focusRect.x,
              y: focusRect.y,
              width: focusRect.width,
              height: focusRect.height,
              opacity: currentIndex >= 0 ? 1 : 0
            },
            transition: {
              duration: animationDuration
            },
            style: {
              '--border-color': borderColor,
              '--glow-color': glowColor
            }
          },
          h('span', { className: 'corner top-left' }),
          h('span', { className: 'corner top-right' }),
          h('span', { className: 'corner bottom-left' }),
          h('span', { className: 'corner bottom-right' })
        )
      );
    }


    // ============================================
    // Lucide Icon Helper
    // ============================================

    function LucideIcon({ name, size = 24, color, className = '', style = {} }) {
      const iconRef = useRef(null);

      useEffect(() => {
        if (iconRef.current && window.lucide) {
          // Use lucide.createIcons() to replace the data-lucide attribute with SVG
          window.lucide.createIcons();

          // Apply color if provided
          if (color) {
            const svg = iconRef.current.querySelector('svg');
            if (svg) {
              svg.setAttribute('stroke', color);
            }
          }
        }
      }, [name, size, color]);

      return h('i', {
        ref: iconRef,
        'data-lucide': name,
        className: `lucide-icon ${className}`,
        style: {
          width: `${size}px`,
          height: `${size}px`,
          display: 'inline-flex',
          alignItems: 'center',
          justifyContent: 'center',
          ...style
        }
      });
    }

    // ============================================
    // ValueFlow Component
    // ============================================

    function ValueFlowVisualization() {
      const [expandedCard, setExpandedCard] = useState(null);

      const toggleCard = (cardId) => {
        setExpandedCard(expandedCard === cardId ? null : cardId);
      };

      return h(
        'div',
        { className: 'value-flow-section' },

        // Header
        h(
          'div',
          { className: 'value-flow-header' },
          h('h2', null, 'How OZONE Creates Value for Everyone'),
          h('p', { className: 'subtitle-persian' }, 'چگونه اُزون برای همه ارزش می‌آفریند'),
          h('p', null, 'Transparent metrics that drive company success AND employee satisfaction'),
          h('p', { className: 'subtitle-persian' }, 'معیارهای شفاف که موفقیت سازمان و رضایت کارکنان را تضمین می‌کنند')
        ),

        // Part 1: Animated Flow Diagram
        h(
          'div',
          { className: 'flow-diagram-container' },
          // SVG Wires and Data Flow
          h(
            'svg',
            { className: 'wire-system', viewBox: '0 0 1000 600', preserveAspectRatio: 'xMidYMid meet' },
            // Defs for gradients and glows
            h(
              'defs',
              null,
              // Gradient for wires
              h('linearGradient', { id: 'wireGradient', x1: '0%', y1: '0%', x2: '100%', y2: '0%' },
                h('stop', { offset: '0%', style: { stopColor: 'rgba(76, 98, 186, 0.6)', stopOpacity: 1 } }),
                h('stop', { offset: '50%', style: { stopColor: 'rgba(118, 75, 162, 0.8)', stopOpacity: 1 } }),
                h('stop', { offset: '100%', style: { stopColor: 'rgba(240, 147, 251, 0.6)', stopOpacity: 1 } })
              ),
              // Glow filter
              h('filter', { id: 'glow' },
                h('feGaussianBlur', { stdDeviation: '3', result: 'coloredBlur' }),
                h('feMerge', null,
                  h('feMergeNode', { in: 'coloredBlur' }),
                  h('feMergeNode', { in: 'SourceGraphic' })
                )
              )
            ),

            // Wire paths from employees to OZONE
            // Designer
            h('path', {
              d: 'M 150 100 Q 325 100, 500 300',
              className: 'wire wire-designer',
              stroke: '#3498db',
              strokeWidth: '3',
              fill: 'none',
              opacity: '0.4',
              filter: 'url(#glow)'
            }),
            h('circle', { className: 'data-packet packet-designer', r: '6', fill: '#3498db' },
              h('animateMotion', {
                dur: '4s',
                repeatCount: 'indefinite',
                path: 'M 150 100 Q 325 100, 500 300'
              })
            ),

            // Engineer
            h('path', {
              d: 'M 150 190 Q 325 190, 500 300',
              className: 'wire wire-engineer',
              stroke: '#2ecc71',
              strokeWidth: '3',
              fill: 'none',
              opacity: '0.4',
              filter: 'url(#glow)'
            }),
            h('circle', { className: 'data-packet packet-engineer', r: '6', fill: '#2ecc71' },
              h('animateMotion', {
                dur: '4.5s',
                repeatCount: 'indefinite',
                path: 'M 150 190 Q 325 190, 500 300'
              })
            ),

            // Operator
            h('path', {
              d: 'M 150 280 Q 325 280, 500 300',
              className: 'wire wire-operator',
              stroke: '#f39c12',
              strokeWidth: '3',
              fill: 'none',
              opacity: '0.4',
              filter: 'url(#glow)'
            }),
            h('circle', { className: 'data-packet packet-operator', r: '6', fill: '#f39c12' },
              h('animateMotion', {
                dur: '3.8s',
                repeatCount: 'indefinite',
                path: 'M 150 280 Q 325 280, 500 300'
              })
            ),

            // Manager
            h('path', {
              d: 'M 150 370 Q 325 370, 500 300',
              className: 'wire wire-manager',
              stroke: '#9b59b6',
              strokeWidth: '3',
              fill: 'none',
              opacity: '0.4',
              filter: 'url(#glow)'
            }),
            h('circle', { className: 'data-packet packet-manager', r: '6', fill: '#9b59b6' },
              h('animateMotion', {
                dur: '4.2s',
                repeatCount: 'indefinite',
                path: 'M 150 370 Q 325 370, 500 300'
              })
            ),

            // Commerce
            h('path', {
              d: 'M 150 460 Q 325 460, 500 300',
              className: 'wire wire-commerce',
              stroke: '#e74c3c',
              strokeWidth: '3',
              fill: 'none',
              opacity: '0.4',
              filter: 'url(#glow)'
            }),
            h('circle', { className: 'data-packet packet-commerce', r: '6', fill: '#e74c3c' },
              h('animateMotion', {
                dur: '3.6s',
                repeatCount: 'indefinite',
                path: 'M 150 460 Q 325 460, 500 300'
              })
            ),

            // Sales
            h('path', {
              d: 'M 150 550 Q 325 550, 500 300',
              className: 'wire wire-sales',
              stroke: '#16a085',
              strokeWidth: '3',
              fill: 'none',
              opacity: '0.4',
              filter: 'url(#glow)'
            }),
            h('circle', { className: 'data-packet packet-sales', r: '6', fill: '#16a085' },
              h('animateMotion', {
                dur: '4.8s',
                repeatCount: 'indefinite',
                path: 'M 150 550 Q 325 550, 500 300'
              })
            ),

            // Wires from OZONE to outputs
            // To Company
            h('path', {
              d: 'M 500 300 Q 675 200, 850 200',
              className: 'wire wire-output-company',
              stroke: 'url(#wireGradient)',
              strokeWidth: '4',
              fill: 'none',
              opacity: '0.5',
              filter: 'url(#glow)'
            }),
            h('circle', { className: 'data-packet packet-output-company', r: '7', fill: '#e74c3c' },
              h('animateMotion', {
                dur: '3s',
                repeatCount: 'indefinite',
                path: 'M 500 300 Q 675 200, 850 200'
              })
            ),

            // To Employees
            h('path', {
              d: 'M 500 300 Q 675 400, 850 400',
              className: 'wire wire-output-employee',
              stroke: 'url(#wireGradient)',
              strokeWidth: '4',
              fill: 'none',
              opacity: '0.5',
              filter: 'url(#glow)'
            }),
            h('circle', { className: 'data-packet packet-output-employee', r: '7', fill: '#27ae60' },
              h('animateMotion', {
                dur: '3.2s',
                repeatCount: 'indefinite',
                path: 'M 500 300 Q 675 400, 850 400'
              })
            )
          ),
          h(
            'div',
            { className: 'flow-diagram' },

            // Employee Input Column
            h(
              'div',
              { className: 'flow-column employees' },
              h(
                'div',
                { className: 'employee-node designer' },
                h('div', { className: 'employee-icon' }, h(LucideIcon, { name: 'palette', size: 32, color: '#3498db' })),
                h(
                  'div',
                  { className: 'employee-info' },
                  h('h4', null, 'Designer ', h('span', { className: 'persian-text' }, '• طراح')),
                  h('p', null, 'Creates products'),
                  h('p', { className: 'persian-subtitle' }, 'محصولات طراحی می‌کند')
                )
              ),
              h(
                'div',
                { className: 'employee-node engineer' },
                h('div', { className: 'employee-icon' }, h(LucideIcon, { name: 'cpu', size: 32, color: '#2ecc71' })),
                h(
                  'div',
                  { className: 'employee-info' },
                  h('h4', null, 'Engineer ', h('span', { className: 'persian-text' }, '• مهندس')),
                  h('p', null, 'Optimizes design'),
                  h('p', { className: 'persian-subtitle' }, 'طراحی را بهینه می‌کند')
                )
              ),
              h(
                'div',
                { className: 'employee-node operator' },
                h('div', { className: 'employee-icon' }, h(LucideIcon, { name: 'cog', size: 32, color: '#f39c12' })),
                h(
                  'div',
                  { className: 'employee-info' },
                  h('h4', null, 'Operator ', h('span', { className: 'persian-text' }, '• اپراتور')),
                  h('p', null, 'Runs machines'),
                  h('p', { className: 'persian-subtitle' }, 'ماشین‌آلات را اداره می‌کند')
                )
              ),
              h(
                'div',
                { className: 'employee-node manager' },
                h('div', { className: 'employee-icon' }, h(LucideIcon, { name: 'briefcase', size: 32, color: '#9b59b6' })),
                h(
                  'div',
                  { className: 'employee-info' },
                  h('h4', null, 'Manager ', h('span', { className: 'persian-text' }, '• مدیر')),
                  h('p', null, 'Oversees production'),
                  h('p', { className: 'persian-subtitle' }, 'بر تولید نظارت می‌کند')
                )
              ),
              h(
                'div',
                { className: 'employee-node commerce' },
                h('div', { className: 'employee-icon' }, h(LucideIcon, { name: 'shopping-cart', size: 32, color: '#e74c3c' })),
                h(
                  'div',
                  { className: 'employee-info' },
                  h('h4', null, 'Commerce ', h('span', { className: 'persian-text' }, '• بازرگانی')),
                  h('p', null, 'Manages orders'),
                  h('p', { className: 'persian-subtitle' }, 'سفارشات را مدیریت می‌کند')
                )
              ),
              h(
                'div',
                { className: 'employee-node sales' },
                h('div', { className: 'employee-icon' }, h(LucideIcon, { name: 'trending-up', size: 32, color: '#16a085' })),
                h(
                  'div',
                  { className: 'employee-info' },
                  h('h4', null, 'Sales ', h('span', { className: 'persian-text' }, '• فروش')),
                  h('p', null, 'Drives revenue'),
                  h('p', { className: 'persian-subtitle' }, 'درآمد ایجاد می‌کند')
                )
              )
            ),

            // OZONE Core Column
            h(
              'div',
              { className: 'flow-column ozone-core' },
              h(
                'div',
                { className: 'ozone-core-container' },
                h('div', { className: 'ozone-logo-text' }, 'OZONE'),
                h(
                  'div',
                  { className: 'ozone-metrics' },
                  h(
                    'div',
                    { className: 'metric-badge' },
                    h('span', { className: 'metric-icon' }, h(LucideIcon, { name: 'bar-chart-2', size: 24 })),
                    h('span', { className: 'metric-label' }, 'KPI Tracking')
                  ),
                  h(
                    'div',
                    { className: 'metric-badge' },
                    h('span', { className: 'metric-icon' }, h(LucideIcon, { name: 'package', size: 24 })),
                    h('span', { className: 'metric-label' }, 'MRP System')
                  ),
                  h(
                    'div',
                    { className: 'metric-badge' },
                    h('span', { className: 'metric-icon' }, h(LucideIcon, { name: 'settings', size: 24 })),
                    h('span', { className: 'metric-label' }, 'BPM Engine')
                  )
                )
              )
            ),

            // Output Column
            h(
              'div',
              { className: 'flow-column outputs' },
              h(
                'div',
                { className: 'output-node company' },
                h('h4', null, h(LucideIcon, { name: 'building-2', size: 20, style: { marginRight: '8px' } }), ' Company Benefits ', h('span', { className: 'persian-text' }, '• مزایای سازمان')),
                h(
                  'ul',
                  null,
                  h('li', null, '34% cost reduction'),
                  h('li', null, '73% faster to market'),
                  h('li', null, '89% fewer errors'),
                  h('li', null, 'Real-time visibility')
                )
              ),
              h(
                'div',
                { className: 'output-node employees' },
                h('h4', null, h(LucideIcon, { name: 'users', size: 20, style: { marginRight: '8px' } }), ' Employee Benefits ', h('span', { className: 'persian-text' }, '• مزایای کارکنان')),
                h(
                  'ul',
                  null,
                  h('li', null, 'Performance bonuses'),
                  h('li', null, 'Skill development'),
                  h('li', null, 'Fair workload'),
                  h('li', null, 'Transparency')
                )
              )
            )
          )
        ),

        // Part 2: Interactive Metric Cards
        h(
          'div',
          { className: 'metric-cards-container' },

          // KPI Card
          h(
            'div',
            {
              className: 'metric-card kpi',
              onClick: () => toggleCard('kpi')
            },
            h(
              'div',
              { className: 'metric-card-header' },
              h('span', { className: 'metric-card-icon' }, h(LucideIcon, { name: 'activity', size: 48, color: '#3498db' })),
              h('h3', null, 'KPI ', h('span', { className: 'persian-text' }, '• شاخص‌های کلیدی')),
              h('h4', null, 'Key Performance Indicators'),
              h('p', null, 'Track efficiency, quality & speed'),
              h('p', { className: 'persian-subtitle' }, 'پیگیری کارایی، کیفیت و سرعت'),
              h('button', { className: 'expand-button' }, 'Learn More ▼ ', h('span', { className: 'persian-text' }, '• اطلاعات بیشتر'))
            )
          ),

          // MRP Card
          h(
            'div',
            {
              className: 'metric-card mrp',
              onClick: () => toggleCard('mrp')
            },
            h(
              'div',
              { className: 'metric-card-header' },
              h('span', { className: 'metric-card-icon' }, h(LucideIcon, { name: 'box', size: 48, color: '#2ecc71' })),
              h('h3', null, 'MRP ', h('span', { className: 'persian-text' }, '• برنامه‌ریزی منابع')),
              h('h4', null, 'Material Resource Planning'),
              h('p', null, 'Optimize inventory & reduce waste'),
              h('p', { className: 'persian-subtitle' }, 'بهینه‌سازی موجودی و کاهش ضایعات'),
              h('button', { className: 'expand-button' }, 'Learn More ▼ ', h('span', { className: 'persian-text' }, '• اطلاعات بیشتر'))
            )
          ),

          // BPM Card
          h(
            'div',
            {
              className: 'metric-card bpm',
              onClick: () => toggleCard('bpm')
            },
            h(
              'div',
              { className: 'metric-card-header' },
              h('span', { className: 'metric-card-icon' }, h(LucideIcon, { name: 'zap', size: 48, color: '#f39c12' })),
              h('h3', null, 'BPM ', h('span', { className: 'persian-text' }, '• مدیریت فرآیند')),
              h('h4', null, 'Business Process Management'),
              h('p', null, 'Streamline & automate workflows'),
              h('p', { className: 'persian-subtitle' }, 'ساده‌سازی و خودکارسازی جریان کار'),
              h('button', { className: 'expand-button' }, 'Learn More ▼ ', h('span', { className: 'persian-text' }, '• اطلاعات بیشتر'))
            )
          )
        ),

        // Modals (rendered outside the cards container)

        // KPI Modal
        expandedCard === 'kpi' && h(
          'div',
          {
            className: 'metric-modal-overlay',
            onClick: () => toggleCard(null)
          },
          h(
            'div',
            {
              className: 'metric-modal-content kpi',
              onClick: (e) => e.stopPropagation()
            },
            h(
              'div',
              { className: 'metric-modal-header' },
              h('span', { className: 'metric-card-icon' }, h(LucideIcon, { name: 'activity', size: 64, color: '#3498db' })),
              h('h2', null, 'KPI - Key Performance Indicators'),
              h('p', { className: 'persian-subtitle', style: { marginTop: '0.5rem', fontSize: '1rem', opacity: 0.8 } }, 'شاخص‌های کلیدی عملکرد'),
              h(
                'button',
                {
                  className: 'modal-close-button',
                  onClick: () => toggleCard(null)
                },
                h(LucideIcon, { name: 'x', size: 24 })
              )
            ),
            h(
              'div',
              { className: 'metric-modal-body' },
              h(
                'div',
                { className: 'metric-card-content' },
                h(
                  'div',
                  { className: 'metric-measures' },
                  h('h5', null, 'What it measures:', h('span', { className: 'persian-text' }, '• چه چیزی را اندازه می‌گیرد')),
                  h(
                    'ul',
                    null,
                    h('li', null, 'Individual & team productivity ', h('span', { className: 'persian-text' }, '• بهره‌وری فردی و تیمی')),
                    h('li', null, 'Quality metrics (defect rates) ', h('span', { className: 'persian-text' }, '• معیارهای کیفیت (نرخ نقص)')),
                    h('li', null, 'Time efficiency (cycle times) ', h('span', { className: 'persian-text' }, '• کارایی زمانی (زمان چرخه)'))
                  )
                ),
                h(
                  'div',
                  { className: 'metric-example' },
                  h('h5', null, 'Real Example:', h('span', { className: 'persian-text' }, '• مثال واقعی')),
                  h('p', null, '"Sarah designed 14 chairs this week"'),
                  h('p', { className: 'persian-subtitle' }, '«سارا این هفته ۱۴ صندلی طراحی کرد»'),
                  h('p', null, '"Team A: 97% quality score, +12% vs last month"'),
                  h('p', { className: 'persian-subtitle' }, '«تیم A: نمره کیفیت ۹۷٪، +۱۲٪ نسبت به ماه گذشته»')
                ),
                h(
                  'div',
                  { className: 'metric-benefits' },
                  h(
                    'div',
                    { className: 'benefit-column company' },
                    h('h6', null, h(LucideIcon, { name: 'building-2', size: 16, style: { marginRight: '6px' } }), ' Company Gets ', h('span', { className: 'persian-text' }, '• سازمان دریافت می‌کند')),
                    h(
                      'ul',
                      null,
                      h('li', null, 'Clear performance metrics ', h('span', { className: 'persian-text' }, '• معیارهای واضح عملکرد')),
                      h('li', null, 'Data-driven decisions ', h('span', { className: 'persian-text' }, '• تصمیمات مبتنی بر داده')),
                      h('li', null, 'Productivity insights ', h('span', { className: 'persian-text' }, '• بینش‌های بهره‌وری')),
                      h('li', null, 'Quality tracking ', h('span', { className: 'persian-text' }, '• پیگیری کیفیت'))
                    )
                  ),
                  h(
                    'div',
                    { className: 'benefit-column employee' },
                    h('h6', null, h(LucideIcon, { name: 'user', size: 16, style: { marginRight: '6px' } }), ' Sarah Gets ', h('span', { className: 'persian-text' }, '• سارا دریافت می‌کند')),
                    h(
                      'ul',
                      null,
                      h('li', null, 'Fair recognition ', h('span', { className: 'persian-text' }, '• شناخت منصفانه')),
                      h('li', null, 'Performance bonus ', h('span', { className: 'persian-text' }, '• پاداش عملکرد')),
                      h('li', null, 'Career growth path ', h('span', { className: 'persian-text' }, '• مسیر رشد شغلی')),
                      h('li', null, 'Transparent evaluation ', h('span', { className: 'persian-text' }, '• ارزیابی شفاف')),
                      h('li', null, 'Skill feedback ', h('span', { className: 'persian-text' }, '• بازخورد مهارتی'))
                    )
                  )
                )
              )
            )
          )
        ),

        // MRP Modal
        expandedCard === 'mrp' && h(
          'div',
          {
            className: 'metric-modal-overlay',
            onClick: () => toggleCard(null)
          },
          h(
            'div',
            {
              className: 'metric-modal-content mrp',
              onClick: (e) => e.stopPropagation()
            },
            h(
              'div',
              { className: 'metric-modal-header' },
              h('span', { className: 'metric-card-icon' }, h(LucideIcon, { name: 'box', size: 64, color: '#2ecc71' })),
              h('h2', null, 'MRP - Material Resource Planning'),
              h('p', { className: 'persian-subtitle', style: { marginTop: '0.5rem', fontSize: '1rem', opacity: 0.8 } }, 'برنامه‌ریزی منابع مواد'),
              h(
                'button',
                {
                  className: 'modal-close-button',
                  onClick: () => toggleCard(null)
                },
                h(LucideIcon, { name: 'x', size: 24 })
              )
            ),
            h(
              'div',
              { className: 'metric-modal-body' },
              h(
                'div',
                { className: 'metric-card-content' },
                h(
                  'div',
                  { className: 'metric-measures' },
                  h('h5', null, 'What it measures:', h('span', { className: 'persian-text' }, '• چه چیزی را اندازه می‌گیرد')),
                  h(
                    'ul',
                    null,
                    h('li', null, 'Material consumption rates ', h('span', { className: 'persian-text' }, '• نرخ مصرف مواد')),
                    h('li', null, 'Inventory levels (real-time) ', h('span', { className: 'persian-text' }, '• سطح موجودی (لحظه‌ای)')),
                    h('li', null, 'Waste generation & reduction ', h('span', { className: 'persian-text' }, '• تولید و کاهش ضایعات'))
                  )
                ),
                h(
                  'div',
                  { className: 'metric-example' },
                  h('h5', null, 'Real Example:', h('span', { className: 'persian-text' }, '• مثال واقعی')),
                  h('p', null, '"Oak usage down 23%, waste reduced 61%"'),
                  h('p', { className: 'persian-subtitle' }, '«مصرف چوب بلوط ۲۳٪ کاهش، ضایعات ۶۱٪ کاهش»'),
                  h('p', null, '"Auto-ordered materials arrive just-in-time"'),
                  h('p', { className: 'persian-subtitle' }, '«مواد سفارش خودکار دقیقاً به موقع می‌رسند»')
                ),
                h(
                  'div',
                  { className: 'metric-benefits' },
                  h(
                    'div',
                    { className: 'benefit-column company' },
                    h('h6', null, h(LucideIcon, { name: 'building-2', size: 16, style: { marginRight: '6px' } }), ' Company Gets ', h('span', { className: 'persian-text' }, '• سازمان دریافت می‌کند')),
                    h(
                      'ul',
                      null,
                      h('li', null, '61% less waste ', h('span', { className: 'persian-text' }, '• ۶۱٪ کمتر ضایعات')),
                      h('li', null, '$200K saved annually ', h('span', { className: 'persian-text' }, '• صرفه‌جویی سالانه ۲۰۰ هزار دلار')),
                      h('li', null, 'Automated ordering ', h('span', { className: 'persian-text' }, '• سفارش خودکار')),
                      h('li', null, 'Optimal stock levels ', h('span', { className: 'persian-text' }, '• سطح بهینه موجودی')),
                      h('li', null, 'Cost control ', h('span', { className: 'persian-text' }, '• کنترل هزینه'))
                    )
                  ),
                  h(
                    'div',
                    { className: 'benefit-column employee' },
                    h('h6', null, h(LucideIcon, { name: 'user', size: 16, style: { marginRight: '6px' } }), ' Employee Gets ', h('span', { className: 'persian-text' }, '• کارکنان دریافت می‌کنند')),
                    h(
                      'ul',
                      null,
                      h('li', null, 'Better tools available ', h('span', { className: 'persian-text' }, '• ابزارهای بهتر در دسترس')),
                      h('li', null, 'No material waits ', h('span', { className: 'persian-text' }, '• بدون انتظار برای مواد')),
                      h('li', null, 'Less frustration ', h('span', { className: 'persian-text' }, '• سرخوردگی کمتر')),
                      h('li', null, 'Smooth workflows ', h('span', { className: 'persian-text' }, '• جریان کاری روان')),
                      h('li', null, 'Quality materials ', h('span', { className: 'persian-text' }, '• مواد باکیفیت'))
                    )
                  )
                )
              )
            )
          )
        ),

        // BPM Modal
        expandedCard === 'bpm' && h(
          'div',
          {
            className: 'metric-modal-overlay',
            onClick: () => toggleCard(null)
          },
          h(
            'div',
            {
              className: 'metric-modal-content bpm',
              onClick: (e) => e.stopPropagation()
            },
            h(
              'div',
              { className: 'metric-modal-header' },
              h('span', { className: 'metric-card-icon' }, h(LucideIcon, { name: 'zap', size: 64, color: '#f39c12' })),
              h('h2', null, 'BPM - Business Process Management'),
              h('p', { className: 'persian-subtitle', style: { marginTop: '0.5rem', fontSize: '1rem', opacity: 0.8 } }, 'مدیریت فرآیندهای کسب‌وکار'),
              h(
                'button',
                {
                  className: 'modal-close-button',
                  onClick: () => toggleCard(null)
                },
                h(LucideIcon, { name: 'x', size: 24 })
              )
            ),
            h(
              'div',
              { className: 'metric-modal-body' },
              h(
                'div',
                { className: 'metric-card-content' },
                h(
                  'div',
                  { className: 'metric-measures' },
                  h('h5', null, 'What it measures:', h('span', { className: 'persian-text' }, '• چه چیزی را اندازه می‌گیرد')),
                  h(
                    'ul',
                    null,
                    h('li', null, 'Process bottlenecks & delays ', h('span', { className: 'persian-text' }, '• گلوگاه‌ها و تأخیرات فرآیند')),
                    h('li', null, 'Workflow cycle times ', h('span', { className: 'persian-text' }, '• زمان چرخه جریان کار')),
                    h('li', null, 'Automation opportunities ', h('span', { className: 'persian-text' }, '• فرصت‌های خودکارسازی'))
                  )
                ),
                h(
                  'div',
                  { className: 'metric-example' },
                  h('h5', null, 'Real Example:', h('span', { className: 'persian-text' }, '• مثال واقعی')),
                  h('p', null, '"Approval time: 48hrs → 18min (Chronos AI)"'),
                  h('p', { className: 'persian-subtitle' }, '«زمان تأیید: ۴۸ساعت ← ۱۸دقیقه (هوش مصنوعی کرونوس)»'),
                  h('p', null, '"Bottleneck detected: auto-reallocated"'),
                  h('p', { className: 'persian-subtitle' }, '«گلوگاه شناسایی شد: تخصیص مجدد خودکار»')
                ),
                h(
                  'div',
                  { className: 'metric-benefits' },
                  h(
                    'div',
                    { className: 'benefit-column company' },
                    h('h6', null, h(LucideIcon, { name: 'building-2', size: 16, style: { marginRight: '6px' } }), ' Company Gets ', h('span', { className: 'persian-text' }, '• سازمان دریافت می‌کند')),
                    h(
                      'ul',
                      null,
                      h('li', null, 'Faster processes ', h('span', { className: 'persian-text' }, '• فرآیندهای سریع‌تر')),
                      h('li', null, 'Automatic routing ', h('span', { className: 'persian-text' }, '• مسیریابی خودکار')),
                      h('li', null, 'Bottleneck fixes ', h('span', { className: 'persian-text' }, '• رفع گلوگاه‌ها')),
                      h('li', null, '73% faster TTM ', h('span', { className: 'persian-text' }, '• ۷۳٪ سریع‌تر به بازار')),
                      h('li', null, 'Efficiency +47% ', h('span', { className: 'persian-text' }, '• کارایی +۴۷٪'))
                    )
                  ),
                  h(
                    'div',
                    { className: 'benefit-column employee' },
                    h('h6', null, h(LucideIcon, { name: 'user', size: 16, style: { marginRight: '6px' } }), ' Employee Gets ', h('span', { className: 'persian-text' }, '• کارکنان دریافت می‌کنند')),
                    h(
                      'ul',
                      null,
                      h('li', null, 'Less bureaucracy ', h('span', { className: 'persian-text' }, '• بوروکراسی کمتر')),
                      h('li', null, 'Clear workflows ', h('span', { className: 'persian-text' }, '• جریان کاری واضح')),
                      h('li', null, 'Balanced workload ', h('span', { className: 'persian-text' }, '• بار کاری متعادل')),
                      h('li', null, 'More creative time ', h('span', { className: 'persian-text' }, '• زمان بیشتر برای خلاقیت')),
                      h('li', null, 'Less repetition ', h('span', { className: 'persian-text' }, '• تکرار کمتر'))
                    )
                  )
                )
              )
            )
          )
        ),

        // Part 3: Benefits Showcase
        h(
          'div',
          { className: 'benefits-showcase' },
          h(
            'div',
            { className: 'benefits-showcase-header' },
            h('h3', null, 'The OZONE Win-Win Model'),
            h('p', { className: 'persian-subtitle', style: { fontSize: '1.15rem', fontWeight: 600 } }, 'مدل برد-برد اُزون'),
            h('p', null, '"Success for company = Success for people"'),
            h('p', { className: 'persian-subtitle' }, '«موفقیت سازمان = موفقیت افراد»')
          ),
          h(
            'div',
            { className: 'benefits-grid' },
            h(
              'div',
              { className: 'benefits-section company-benefits' },
              h('h4', null, h(LucideIcon, { name: 'building-2', size: 24, style: { marginRight: '8px' } }), ' Company Benefits ', h('span', { className: 'persian-text' }, '• مزایای سازمان')),
              h(
                'div',
                { className: 'benefits-list' },
                h(
                  'div',
                  { className: 'benefit-item' },
                  h('span', { className: 'benefit-emoji' }, h(LucideIcon, { name: 'dollar-sign', size: 24 })),
                  h('span', { className: 'benefit-text' }, '34% cost reduction ', h('span', { className: 'persian-text' }, '• ۳۴٪ کاهش هزینه'))
                ),
                h(
                  'div',
                  { className: 'benefit-item' },
                  h('span', { className: 'benefit-emoji' }, h(LucideIcon, { name: 'trending-up', size: 24 })),
                  h('span', { className: 'benefit-text' }, '73% faster time-to-market ', h('span', { className: 'persian-text' }, '• ۷۳٪ سریع‌تر به بازار'))
                ),
                h(
                  'div',
                  { className: 'benefit-item' },
                  h('span', { className: 'benefit-emoji' }, h(LucideIcon, { name: 'target', size: 24 })),
                  h('span', { className: 'benefit-text' }, '89% fewer errors ', h('span', { className: 'persian-text' }, '• ۸۹٪ خطای کمتر'))
                ),
                h(
                  'div',
                  { className: 'benefit-item' },
                  h('span', { className: 'benefit-emoji' }, h(LucideIcon, { name: 'bar-chart-2', size: 24 })),
                  h('span', { className: 'benefit-text' }, 'Real-time visibility ', h('span', { className: 'persian-text' }, '• شفافیت لحظه‌ای'))
                ),
                h(
                  'div',
                  { className: 'benefit-item' },
                  h('span', { className: 'benefit-emoji' }, h(LucideIcon, { name: 'refresh-cw', size: 24 })),
                  h('span', { className: 'benefit-text' }, 'Zero data loss ', h('span', { className: 'persian-text' }, '• صفر از دست رفتن داده'))
                ),
                h(
                  'div',
                  { className: 'benefit-item' },
                  h('span', { className: 'benefit-emoji' }, h(LucideIcon, { name: 'cpu', size: 24 })),
                  h('span', { className: 'benefit-text' }, 'AI-driven decisions ', h('span', { className: 'persian-text' }, '• تصمیمات هوشمند'))
                ),
                h(
                  'div',
                  { className: 'benefit-item' },
                  h('span', { className: 'benefit-emoji' }, h(LucideIcon, { name: 'globe', size: 24 })),
                  h('span', { className: 'benefit-text' }, 'Global coordination ', h('span', { className: 'persian-text' }, '• هماهنگی جهانی'))
                )
              )
            ),
            h(
              'div',
              { className: 'benefits-section employee-benefits' },
              h('h4', null, h(LucideIcon, { name: 'users', size: 24, style: { marginRight: '8px' } }), ' Employee Benefits ', h('span', { className: 'persian-text' }, '• مزایای کارکنان')),
              h(
                'div',
                { className: 'benefits-list' },
                h(
                  'div',
                  { className: 'benefit-item' },
                  h('span', { className: 'benefit-emoji' }, h(LucideIcon, { name: 'coins', size: 24 })),
                  h('span', { className: 'benefit-text' }, 'Performance bonuses ', h('span', { className: 'persian-text' }, '• پاداش عملکرد'))
                ),
                h(
                  'div',
                  { className: 'benefit-item' },
                  h('span', { className: 'benefit-emoji' }, h(LucideIcon, { name: 'graduation-cap', size: 24 })),
                  h('span', { className: 'benefit-text' }, 'Skill development insights ', h('span', { className: 'persian-text' }, '• بینش توسعه مهارت'))
                ),
                h(
                  'div',
                  { className: 'benefit-item' },
                  h('span', { className: 'benefit-emoji' }, h(LucideIcon, { name: 'scale', size: 24 })),
                  h('span', { className: 'benefit-text' }, 'Fair workload distribution ', h('span', { className: 'persian-text' }, '• توزیع عادلانه بار کار'))
                ),
                h(
                  'div',
                  { className: 'benefit-item' },
                  h('span', { className: 'benefit-emoji' }, h(LucideIcon, { name: 'eye', size: 24 })),
                  h('span', { className: 'benefit-text' }, 'Complete transparency ', h('span', { className: 'persian-text' }, '• شفافیت کامل'))
                ),
                h(
                  'div',
                  { className: 'benefit-item' },
                  h('span', { className: 'benefit-emoji' }, h(LucideIcon, { name: 'award', size: 24 })),
                  h('span', { className: 'benefit-text' }, 'Recognition & credit ', h('span', { className: 'persian-text' }, '• شناخت و اعتبار'))
                ),
                h(
                  'div',
                  { className: 'benefit-item' },
                  h('span', { className: 'benefit-emoji' }, h(LucideIcon, { name: 'wrench', size: 24 })),
                  h('span', { className: 'benefit-text' }, 'Better tools & resources ', h('span', { className: 'persian-text' }, '• ابزار و منابع بهتر'))
                ),
                h(
                  'div',
                  { className: 'benefit-item' },
                  h('span', { className: 'benefit-emoji' }, h(LucideIcon, { name: 'handshake', size: 24 })),
                  h('span', { className: 'benefit-text' }, 'Easier collaboration ', h('span', { className: 'persian-text' }, '• همکاری آسان‌تر'))
                )
              )
            )
          )
        )
      );
    }

    // ============================================
    // MacOS Window Component
    // ============================================

    function MacOSWindow({ title = 'Window', children, className = '', isFullscreen = false }) {
      return h(
        motion.div,
        {
          className: `macos-window ${className} ${isFullscreen ? 'fullscreen' : ''}`,
          initial: { scale: 0.9, opacity: 0 },
          animate: {
            scale: 1,
            opacity: 1
          },
          transition: { duration: 0.4, type: 'spring', damping: 20 }
        },
        // Title Bar
        h(
          'div',
          { className: 'macos-titlebar' },
          // Traffic Lights
          h(
            'div',
            { className: 'macos-traffic-lights' },
            h('div', { className: 'macos-traffic-light close' }),
            h('div', { className: 'macos-traffic-light minimize' }),
            h('div', { className: 'macos-traffic-light maximize' })
          ),
          // Window Title
          h('div', { className: 'macos-window-title' }, title)
        ),
        // Content
        h('div', { className: 'macos-window-content' }, children)
      );
    }

    // ============================================
    // Slide Components
    // ============================================

    function Slide1() {
      const containerRef = useRef(null);

      return h(
        'div',
        { className: 'slide-hero', ref: containerRef },
        h(
          'div',
          { className: 'hero-content' },
          h(
            'div',
            { className: 'ozone-logo' },
            h(VariableProximity, {
              label: 'OZONE',
              fromFontVariationSettings: "'wght' 400",
              toFontVariationSettings: "'wght' 900",
              containerRef: containerRef,
              radius: 200,
              falloff: 'exponential'
            })
          ),
          h('div', { className: 'ozone-tagline' }, 'The Mutual Language of Design and Production')
        )
      );
    }

    function Slide2({ onSystemClick }) {
      const philosophyItems = [
        {
          english: h(React.Fragment, null, 'One ', h('em', null, 'System')),
          persian: 'یک سیستم'
        },
        {
          english: h(React.Fragment, null, 'One ', h('em', null, 'Tool')),
          persian: 'یک ابزار'
        },
        {
          english: h(React.Fragment, null, 'One ', h('em', null, 'Design')),
          persian: 'یک طرح'
        }
      ];

      return h(
        'div',
        { className: 'slide-philosophy' },
        h(
          'div',
          { className: 'philosophy-content' },
          h('div', { className: 'philosophy-title' }, 'The Philosophy'),
          h(
            'div',
            {
              className: 'philosophy-focus',
              onClick: (e) => {
                // Check if "One System" was clicked (index 0)
                const target = e.target.closest('.focus-word');
                if (target && target === target.parentElement.children[0]) {
                  onSystemClick();
                }
              }
            },
            h(BilingualTrueFocus, {
              items: philosophyItems,
              manualMode: true,
              blurAmount: 8,
              borderColor: '#4c62ba',
              glowColor: 'rgba(76, 98, 186, 0.6)',
              animationDuration: 0.6
            })
          )
        )
      );
    }

    function Slide3() {
      const [isFullscreen, setIsFullscreen] = useState(false);
      const slideRef = useRef(null);
      const windowRef = useRef(null);
      const isTransitioningRef = useRef(false);

      useEffect(() => {
        let wheelTimeout = null;

        const handleWheel = (e) => {
          // Check if we're on the active slide
          if (!slideRef.current || !slideRef.current.closest('.slide.active')) {
            return;
          }

          // If already transitioning, ignore
          if (isTransitioningRef.current) {
            return;
          }

          // Check if the scroll event originated from within the macOS window
          const isOverWindow = windowRef.current && windowRef.current.contains(e.target);

          const scrollThreshold = 20;
          const deltaY = e.deltaY;

          console.log('Scroll event:', {
            deltaY,
            isFullscreen,
            isOverWindow,
            isTransitioning: isTransitioningRef.current,
            willGoFullscreen: deltaY > scrollThreshold && !isFullscreen && isOverWindow
          });

          // Scrolling down over the window - go fullscreen
          if (deltaY > scrollThreshold && !isFullscreen && isOverWindow) {
            console.log('>>> GOING FULLSCREEN');
            e.preventDefault();
            isTransitioningRef.current = true;
            setIsFullscreen(true);

            if (wheelTimeout) clearTimeout(wheelTimeout);
            wheelTimeout = setTimeout(() => {
              isTransitioningRef.current = false;
              console.log('Fullscreen transition complete');
            }, 1200);
          }
        };

        const handleMessage = (e) => {
          // Listen for messages from the iframe (dashboard)
          if (e.data && e.data.type === 'EXIT_FULLSCREEN') {
            console.log('>>> RECEIVED EXIT_FULLSCREEN MESSAGE FROM DASHBOARD');

            if (isFullscreen && !isTransitioningRef.current) {
              isTransitioningRef.current = true;
              setIsFullscreen(false);

              if (wheelTimeout) clearTimeout(wheelTimeout);
              wheelTimeout = setTimeout(() => {
                isTransitioningRef.current = false;
                console.log('Windowed transition complete');
              }, 1200);
            }
          }
        };

        const handleKeyDown = (e) => {
          // ESC key should ALWAYS exit fullscreen, regardless of which slide is active
          if (e.key === 'Escape' && isFullscreen) {
            console.log('>>> ESC KEY PRESSED - EXITING FULLSCREEN');
            e.preventDefault();
            e.stopPropagation();
            setIsFullscreen(false);
            return;
          }

          // Other keys only work when slide is active
          if (slideRef.current && slideRef.current.closest('.slide.active')) {
            if (e.key === 'f' || e.key === 'F') {
              e.preventDefault();
              setIsFullscreen(prev => !prev);
            }
          }
        };

        // When windowed, listen on slide element for scroll-down
        const slideElement = slideRef.current;

        if (!isFullscreen && slideElement) {
          slideElement.addEventListener('wheel', handleWheel, { passive: false });
        }

        // Always listen for messages from iframe
        window.addEventListener('message', handleMessage);
        window.addEventListener('keydown', handleKeyDown, true); // Use capture phase to get event first

        return () => {
          if (slideElement) {
            slideElement.removeEventListener('wheel', handleWheel);
          }
          window.removeEventListener('message', handleMessage);
          window.removeEventListener('keydown', handleKeyDown, true);
          if (wheelTimeout) {
            clearTimeout(wheelTimeout);
          }
        };
      }, [isFullscreen]);

      // Exit fullscreen when slide becomes inactive
      useEffect(() => {
        const checkSlideActive = () => {
          if (slideRef.current && !slideRef.current.closest('.slide.active') && isFullscreen) {
            console.log('>>> SLIDE BECAME INACTIVE - EXITING FULLSCREEN');
            setIsFullscreen(false);
          }
        };

        // Check periodically (simple approach)
        const interval = setInterval(checkSlideActive, 100);

        return () => clearInterval(interval);
      }, [isFullscreen]);

      return h(
        'div',
        {
          ref: slideRef,
          className: `slide-one-system ${isFullscreen ? 'fullscreen' : ''}`
        },
        // Header Section
        h(
          'div',
          { className: 'one-system-header' },
          h('h1', { className: 'one-system-title' }, 'One System'),
          h('p', { className: 'one-system-subtitle' }, 'یک سیستم یکپارچه برای طراحی و تولید')
        ),

        // Scrollable Content Sections (hidden in fullscreen)
        !isFullscreen && h(
          'div',
          { className: 'one-system-scrollable-content' },

          // Section 1: Overview
          h(
            'div',
            { className: 'content-section' },
            h('h2', null, 'Unified Platform ', h('span', { className: 'persian-text' }, '• پلتفرم یکپارچه')),
            h('p', null, 'OZONE brings together every aspect of your manufacturing and design process into one seamless, integrated platform. No more switching between disconnected tools or losing data in translation.'),
            h('p', { className: 'persian-subtitle' }, 'اُزون تمام جنبه‌های فرآیند تولید و طراحی شما را در یک پلتفرم یکپارچه گردهم می‌آورد. دیگر نیازی به جابجایی بین ابزارهای مختلف یا از دست دادن داده‌ها نیست.'),
            h('p', null, 'From initial concept to final delivery, manage everything in one place with real-time visibility and control.'),
            h('p', { className: 'persian-subtitle' }, 'از ایده اولیه تا تحویل نهایی، همه چیز را در یک مکان با شفافیت و کنترل لحظه‌ای مدیریت کنید.')
          ),

          // Section 2: ValueFlow Visualization (KPI/MRP/BPM)
          h(ValueFlowVisualization),

          // Section 3: Key Features
          h(
            'div',
            { className: 'content-section' },
            h('h2', null, 'Core Capabilities ', h('span', { className: 'persian-text' }, '• قابلیت‌های اصلی')),
            h(
              'div',
              { className: 'features-grid' },
              h(
                'div',
                { className: 'feature-card' },
                h('h3', null, 'Real-Time Analytics ', h('span', { className: 'persian-text' }, '• تحلیل لحظه‌ای')),
                h('p', null, 'Live dashboards with instant insights into operations, finances, and team performance.'),
                h('p', { className: 'persian-subtitle' }, 'داشبوردهای زنده با بینش لحظه‌ای از عملیات، مالی و عملکرد تیم.')
              ),
              h(
                'div',
                { className: 'feature-card' },
                h('h3', null, 'Unified Data Model ', h('span', { className: 'persian-text' }, '• مدل داده یکپارچه')),
                h('p', null, 'Single source of truth for all your business data, ensuring consistency across all departments.'),
                h('p', { className: 'persian-subtitle' }, 'منبع واحد حقیقت برای تمام داده‌های کسب‌وکار، تضمین ثبات در تمام بخش‌ها.')
              ),
              h(
                'div',
                { className: 'feature-card' },
                h('h3', null, 'Smart Automation ', h('span', { className: 'persian-text' }, '• خودکارسازی هوشمند')),
                h('p', null, 'AI-powered workflows that eliminate repetitive tasks and optimize resource allocation.'),
                h('p', { className: 'persian-subtitle' }, 'جریان کاری مبتنی بر هوش مصنوعی که وظایف تکراری را حذف و تخصیص منابع را بهینه می‌کند.')
              ),
              h(
                'div',
                { className: 'feature-card' },
                h('h3', null, 'Collaborative Tools ', h('span', { className: 'persian-text' }, '• ابزارهای همکاری')),
                h('p', null, 'Built-in communication and project management tools that keep your team aligned.'),
                h('p', { className: 'persian-subtitle' }, 'ابزارهای ارتباطی و مدیریت پروژه داخلی که تیم شما را هماهنگ نگه می‌دارد.')
              )
            )
          ),

          // Section 4: Call to Action
          h(
            'div',
            { className: 'content-section' },
            h('h2', null, 'Experience the Dashboard ', h('span', { className: 'persian-text' }, '• داشبورد را تجربه کنید')),
            h('p', null, 'Scroll down to see the interactive manager\'s dashboard that demonstrates the power of unified data visualization.'),
            h('p', { className: 'persian-subtitle' }, 'برای مشاهده داشبورد تعاملی مدیر که قدرت تصویرسازی داده یکپارچه را نشان می‌دهد، به پایین اسکرول کنید.')
          ),

          // Scroll Indicator (only visible when not fullscreen)
          h(
            'div',
            { className: 'scroll-indicator' },
            h('div', { className: 'scroll-indicator-text' }, 'Scroll down to see the dashboard ', h('span', { className: 'persian-text' }, '• برای مشاهده داشبورد اسکرول کنید')),
            h('div', { className: 'scroll-indicator-icon' })
          )
        ),

        // macOS Window with Embedded Dashboard (at the very bottom)
        h(
          'div',
          { className: 'one-system-content', ref: windowRef },

          // Dashboard intro text (hidden in fullscreen)
          !isFullscreen && h(
            'div',
            { className: 'dashboard-intro' },
            h('h3', null, 'Interactive Manager Dashboard ', h('span', { className: 'persian-text' }, '• داشبورد تعاملی مدیر')),
            h('p', null, 'Scroll over the window to go fullscreen'),
            h('p', { className: 'persian-subtitle' }, 'برای تمام صفحه شدن، روی پنجره اسکرول کنید')
          ),

          h(
            MacOSWindow,
            { title: 'OZONE Manager Dashboard', isFullscreen },
            h('iframe', {
              src: './Presentation/managers-dashboard/manager-dashboard.html',
              title: 'OZONE Manager Dashboard',
              style: { background: 'white' }
            })
          )
        ),
        h('div', { className: 'back-hint' },
          isFullscreen
            ? h('span', null, 'Press ESC or scroll up to exit fullscreen ', h('span', { className: 'persian-text' }, '• برای خروج ESC بزنید یا بالا اسکرول کنید'))
            : h('span', null, 'Press ← to go back ', h('span', { className: 'persian-text' }, '• برای بازگشت ← بزنید'))
        )
      );
    }

    // ============================================
    // Main App
    // ============================================

    function App() {
      const [currentSlide, setCurrentSlide] = useState(0);
      const totalSlides = 3;

      useEffect(() => {
        const handleKeyDown = (e) => {
          if (e.key === 'ArrowRight' || e.key === 'ArrowDown') {
            setCurrentSlide(prev => Math.min(prev + 1, totalSlides - 1));
          } else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {
            setCurrentSlide(prev => Math.max(prev - 1, 0));
          }
        };

        window.addEventListener('keydown', handleKeyDown);
        return () => window.removeEventListener('keydown', handleKeyDown);
      }, []);

      const handleSystemClick = () => {
        setCurrentSlide(2); // Navigate to slide 3 (One System)
      };

      return h(
        React.Fragment,
        null,
        // Global MetaBalls Background
        h(
          'div',
          { className: 'global-metaballs-background' },
          h(MetaBalls, {
            color: '#4c62ba',
            cursorBallColor: '#6a7fc1',
            cursorBallSize: 2,
            ballCount: 12,
            animationSize: 40,
            enableMouseInteraction: true,
            enableTransparency: true,
            hoverSmoothness: 0.05,
            clumpFactor: 1.2,
            speed: 0.2
          })
        ),
        // Presentation Container
        h(
          'div',
          { className: 'presentation-container' },
          // Slide 1
          h(
            'div',
            { className: `slide ${currentSlide === 0 ? 'active' : ''}` },
            h(Slide1)
          ),
          // Slide 2
          h(
            'div',
            { className: `slide ${currentSlide === 1 ? 'active' : ''}` },
            h(Slide2, { onSystemClick: handleSystemClick })
          ),
          // Slide 3
          h(
            'div',
            { className: `slide ${currentSlide === 2 ? 'active' : ''}` },
            h(Slide3)
          ),
          // Navigation Indicators
          h(
            'div',
            { className: 'slide-indicators' },
            Array.from({ length: totalSlides }).map((_, index) =>
              h('div', {
                key: index,
                className: `indicator ${currentSlide === index ? 'active' : ''}`,
                onClick: () => setCurrentSlide(index),
                title: `Slide ${index + 1}`
              })
            )
          )
        )
      );
    }

    // Render
    const root = createRoot(document.getElementById('root'));
    root.render(h(App));
  </script>
</body>
</html>
